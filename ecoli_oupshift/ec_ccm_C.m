function mol=ec_ccm_C(free_net,free_xch,in)

kernel_net=[ -0 -0 -0 -0 -1 -2 2 1 -0 -0 -0 -0 -0 -0 -0 1 -0 -0 -0;
 -0 -0 0.5 0.5 1 1.5 -1.5 -0 1 -0 -0 -0 -0 0.5 -0 -0.5 0.5 -0.5 -0;
 -0 -0 -0 -1 -2 -4 4 -0 -0 1 -0 -0 -0 -0 -0 2 -0 -0 -0;
 -0 -0 -1 -0 -0 -0 -0 -0 -0 -0 1 -0 -0 -0 -0 -0 -1 -1 -0;
 -0 -0 -1 -1 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 1;
 -0 -0 -0 -0 -1 1 -1 -0 -0 -0 -0 -0 -0 -0 1 -0 -0 -0 -0;
 -1 -1 0.5 0.5 1 -0.5 0.5 -0 -0 -0 -0 1 1 0.5 -0 0.5 0.5 0.5 -0;
 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 -0 -0 0.5 -0.5 -0 -2.5 2.5 -0 -0 -0 -0 -0 1 0.5 -0 1.5 0.5 0.5 -0;
 -0 -0 0.5 -0.5 -0 -0.5 1.5 -0 -0 -0 -0 -0 -0 0.5 -0 0.5 0.5 0.5 -0;
 -0 -0 0.5 -0.5 -0 -0.5 1.5 -0 -0 -0 -0 -0 -0 0.5 -0 0.5 0.5 0.5 -0;
 -0 -0 0.5 -0.5 -0 -0.5 0.5 -0 -0 -0 -0 -0 -0 -0.5 -0 0.5 0.5 0.5 -0;
 -0 -0 1 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 1 1 -0;
 -0 -0 1 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 1 1 -0;
 -0 -0 1 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 1 -0;
 -0 -0 1 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 1 -0;
 -0 -0 1 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 1 -0;
 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 -0 -0 -0 1 1 2 -2 -0 -0 -0 -0 -0 -0 -0 -0 -1 -0 -0 -0;
 -0 -0 -0 1 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0;
 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 -0 -0 -0 -0 1 2 -2 -0 -0 -0 -0 -0 -0 -0 -0 -1 -0 -0 -0;
 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 -0 -0 -0 -0 -0 2 -2 -0 -0 -0 -0 -0 -0 -0 -0 -1 -0 -0 -0;
 -0 -0 -0 -0 -0 1 -1 0 0 0 0 0 0 0 0 -1 0 0 0;
 -0 -0 -0 -0 -0 1 -1 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0;
 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0;
 -0 -0 -0 -0 -0 -0 1 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0 -0;
 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

kernel_xch=[ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1];

net=sparse(kernel_net)*free_net;
xch=sparse(kernel_xch)*free_xch;

f=xch+max(0,net);
b=xch-min(0,net);

%%
A1=zeros(88);
A1(1,1)=-b(1)-b(23)-f(31);
A1(1,12)=f(23);
A1(2,2)=-b(10)-b(26)-b(28)-f(11)-f(36);
A1(2,5)=f(28);
A1(2,9)=f(26);
A1(2,13)=f(10);
A1(2,14)=b(11);
A1(3,3)=-b(12)-f(13)-f(29)-f(37);
A1(3,14)=f(12);
A1(3,15)=b(13);
A1(3,16)=b(29);
A1(4,4)=-b(25)-f(26)-f(27);
A1(4,6)=b(26);
A1(4,7)=b(27);
A1(4,17)=f(25);
A1(5,2)=b(28);
A1(5,5)=-b(27)-b(30)-f(28);
A1(5,10)=f(27);
A1(5,16)=f(30);
A1(6,4)=f(26);
A1(6,6)=-b(10)-b(26)-b(28)-f(11)-f(36);
A1(6,7)=f(28);
A1(6,18)=f(10);
A1(6,19)=b(11);
A1(7,4)=f(27);
A1(7,6)=b(28);
A1(7,7)=-b(27)-b(30)-f(28);
A1(7,20)=f(30);
A1(8,8)=-b(5)-b(19)-b(22)-f(42);
A1(8,21)=f(19);
A1(8,22)=f(22);
A1(9,2)=b(26);
A1(9,9)=-b(28)-f(26)-f(29)-f(39);
A1(9,23)=f(28);
A1(9,24)=b(29);
A1(10,5)=b(27);
A1(10,10)=-b(6)-b(24)-f(27)-f(38);
A1(10,11)=f(24);
A1(11,10)=b(24);
A1(11,11)=-b(23)-f(24)-f(25);
A1(11,25)=f(23);
A1(11,26)=b(25);
A1(12,1)=b(23);
A1(12,12)=-b(20)-f(21)-f(23);
A1(12,27)=f(20);
A1(12,28)=b(21);
A1(13,2)=b(10);
A1(13,13)=-b(7)-b(8)-b(9)-f(10)-f(20)-f(35);
A1(13,29)=b(20);
A1(14,2)=f(11);
A1(14,3)=b(12);
A1(14,14)=-b(11)-f(12);
A1(15,3)=f(13);
A1(15,15)=-b(12)-b(13)-b(22)-b(26)-b(27)-f(14)-f(28);
A1(15,30)=f(12);
A1(15,31)=f(22);
A1(15,32)=f(26)+f(27);
A1(15,33)=b(14);
A1(15,34)=b(28);
A1(16,3)=f(29);
A1(16,5)=b(30);
A1(16,16)=-b(29)-f(30);
A1(17,4)=b(25);
A1(17,17)=-b(23)-f(24)-f(25);
A1(17,29)=f(23);
A1(17,35)=b(24);
A1(18,6)=b(10);
A1(18,18)=-b(7)-b(8)-b(9)-f(10)-f(20)-f(35);
A1(18,25)=b(20);
A1(19,6)=f(11);
A1(19,19)=-b(11)-f(12);
A1(19,36)=b(12);
A1(20,7)=b(30);
A1(20,20)=-b(29)-f(30);
A1(20,36)=f(29);
A1(21,8)=b(19);
A1(21,21)=-b(18)-f(19)-f(41);
A1(21,37)=f(18);
A1(22,8)=b(22);
A1(22,22)=-b(21)-f(22);
A1(22,29)=f(21);
A1(23,9)=b(28);
A1(23,23)=-b(27)-b(30)-f(28);
A1(23,24)=f(30);
A1(23,35)=f(27);
A1(24,9)=f(29);
A1(24,23)=b(30);
A1(24,24)=-b(29)-f(30);
A1(25,11)=b(23);
A1(25,18)=f(20);
A1(25,25)=-b(20)-f(21)-f(23);
A1(25,38)=b(21);
A1(26,11)=f(25);
A1(26,26)=-b(25)-f(26)-f(27);
A1(26,39)=b(26);
A1(26,40)=b(27);
A1(27,12)=b(20);
A1(27,27)=-b(7)-b(8)-b(9)-f(10)-f(20)-f(35);
A1(27,39)=b(10);
A1(28,12)=f(21);
A1(28,28)=-b(21)-f(22);
A1(28,41)=b(22);
A1(29,13)=f(20);
A1(29,17)=b(23);
A1(29,22)=b(21);
A1(29,29)=-b(20)-f(21)-f(23);
A1(30,15)=b(12);
A1(30,30)=-b(11)-f(12);
A1(30,34)=f(11);
A1(31,15)=b(22);
A1(31,31)=-b(21)-f(22);
A1(31,42)=f(21);
A1(32,15)=b(26)+b(27);
A1(32,32)=-b(25)-f(26)-f(27);
A1(32,43)=f(25);
A1(33,15)=f(14);
A1(33,33)=-b(14)-f(15);
A1(33,44)=b(15);
A1(34,15)=f(28);
A1(34,30)=b(11);
A1(34,34)=-b(10)-b(26)-b(28)-f(11)-f(36);
A1(34,45)=f(10);
A1(34,46)=f(26);
A1(35,17)=f(24);
A1(35,23)=b(27);
A1(35,35)=-b(6)-b(24)-f(27)-f(38);
A1(36,19)=f(12);
A1(36,20)=b(29);
A1(36,36)=-b(12)-f(13)-f(29)-f(37);
A1(36,47)=b(13);
A1(37,21)=b(18);
A1(37,37)=-b(17)-f(18);
A1(37,48)=f(17);
A1(38,25)=f(21);
A1(38,38)=-b(21)-f(22);
A1(38,49)=b(22);
A1(39,26)=f(26);
A1(39,27)=f(10);
A1(39,39)=-b(10)-b(26)-b(28)-f(11)-f(36);
A1(39,40)=f(28);
A1(39,50)=b(11);
A1(40,26)=f(27);
A1(40,39)=b(28);
A1(40,40)=-b(27)-b(30)-f(28);
A1(40,51)=f(30);
A1(41,28)=f(22);
A1(41,41)=-b(5)-b(19)-b(22)-f(42);
A1(41,52)=f(19);
A1(42,31)=b(21);
A1(42,42)=-b(20)-f(21)-f(23);
A1(42,43)=b(23);
A1(42,45)=f(20);
A1(43,32)=b(25);
A1(43,42)=f(23);
A1(43,43)=-b(23)-f(24)-f(25);
A1(43,53)=b(24);
A1(44,33)=f(15);
A1(44,44)=-b(15)-f(16)-f(40);
A1(44,54)=b(16);
A1(45,34)=b(10);
A1(45,42)=b(20);
A1(45,45)=-b(7)-b(8)-b(9)-f(10)-f(20)-f(35);
A1(46,34)=b(26);
A1(46,46)=-b(28)-f(26)-f(29)-f(39);
A1(46,55)=f(28);
A1(46,56)=b(29);
A1(47,36)=f(13);
A1(47,47)=-b(12)-b(13)-b(22)-b(26)-b(27)-f(14)-f(28);
A1(47,57)=f(12);
A1(47,58)=f(22);
A1(47,59)=f(26)+f(27);
A1(47,60)=b(14);
A1(47,61)=b(28);
A1(48,37)=b(17);
A1(48,48)=-b(16)-f(17);
A1(48,62)=f(16);
A1(49,38)=f(22);
A1(49,49)=-b(5)-b(19)-b(22)-f(42);
A1(49,63)=f(19);
A1(50,39)=f(11);
A1(50,50)=-b(11)-f(12);
A1(50,64)=b(12);
A1(51,40)=b(30);
A1(51,51)=-b(29)-f(30);
A1(51,64)=f(29);
A1(52,41)=b(19);
A1(52,52)=-b(18)-f(19)-f(41);
A1(52,65)=f(18);
A1(53,43)=f(24);
A1(53,53)=-b(6)-b(24)-f(27)-f(38);
A1(53,55)=b(27);
A1(54,44)=f(16);
A1(54,54)=-b(16)-f(17);
A1(54,65)=b(17);
A1(55,46)=b(28);
A1(55,53)=f(27);
A1(55,55)=-b(27)-b(30)-f(28);
A1(55,56)=f(30);
A1(56,46)=f(29);
A1(56,55)=b(30);
A1(56,56)=-b(29)-f(30);
A1(57,47)=b(12);
A1(57,57)=-b(11)-f(12);
A1(57,61)=f(11);
A1(58,47)=b(22);
A1(58,58)=-b(21)-f(22);
A1(58,66)=f(21);
A1(59,47)=b(26)+b(27);
A1(59,59)=-b(25)-f(26)-f(27);
A1(59,67)=f(25);
A1(60,47)=f(14);
A1(60,60)=-b(14)-f(15);
A1(60,68)=b(15);
A1(61,47)=f(28);
A1(61,57)=b(11);
A1(61,61)=-b(10)-b(26)-b(28)-f(11)-f(36);
A1(61,69)=f(10);
A1(61,70)=f(26);
A1(62,48)=b(16);
A1(62,62)=-b(15)-f(16)-f(40);
A1(62,71)=f(15);
A1(63,49)=b(19);
A1(63,63)=-b(18)-f(19)-f(41);
A1(63,72)=f(18);
A1(64,50)=f(12);
A1(64,51)=b(29);
A1(64,64)=-b(12)-f(13)-f(29)-f(37);
A1(64,73)=b(13);
A1(65,52)=b(18);
A1(65,54)=f(17);
A1(65,65)=-b(17)-f(18);
A1(66,58)=b(21);
A1(66,66)=-b(20)-f(21)-f(23);
A1(66,67)=b(23);
A1(66,69)=f(20);
A1(67,59)=b(25);
A1(67,66)=f(23);
A1(67,67)=-b(23)-f(24)-f(25);
A1(67,74)=b(24);
A1(68,60)=f(15);
A1(68,68)=-b(15)-f(16)-f(40);
A1(68,75)=b(16);
A1(69,61)=b(10);
A1(69,66)=b(20);
A1(69,69)=-b(7)-b(8)-b(9)-f(10)-f(20)-f(35);
A1(70,61)=b(26);
A1(70,70)=-b(28)-f(26)-f(29)-f(39);
A1(70,76)=f(28);
A1(70,77)=b(29);
A1(71,62)=b(15);
A1(71,71)=-b(14)-f(15);
A1(71,73)=f(14);
A1(72,63)=b(18);
A1(72,72)=-b(17)-f(18);
A1(72,75)=f(17);
A1(73,64)=f(13);
A1(73,71)=b(14);
A1(73,73)=-b(12)-b(13)-b(22)-b(26)-b(27)-f(14)-f(28);
A1(73,78)=f(12);
A1(73,79)=f(22);
A1(73,80)=f(26)+f(27);
A1(73,81)=b(28);
A1(74,67)=f(24);
A1(74,74)=-b(6)-b(24)-f(27)-f(38);
A1(74,76)=b(27);
A1(75,68)=f(16);
A1(75,72)=b(17);
A1(75,75)=-b(16)-f(17);
A1(76,70)=b(28);
A1(76,74)=f(27);
A1(76,76)=-b(27)-b(30)-f(28);
A1(76,77)=f(30);
A1(77,70)=f(29);
A1(77,76)=b(30);
A1(77,77)=-b(29)-f(30);
A1(78,73)=b(12);
A1(78,78)=-b(11)-f(12);
A1(78,81)=f(11);
A1(79,73)=b(22);
A1(79,79)=-b(21)-f(22);
A1(79,82)=f(21);
A1(80,73)=b(26)+b(27);
A1(80,80)=-b(25)-f(26)-f(27);
A1(80,83)=f(25);
A1(81,73)=f(28);
A1(81,78)=b(11);
A1(81,81)=-b(10)-b(26)-b(28)-f(11)-f(36);
A1(81,84)=f(10);
A1(81,85)=f(26);
A1(82,79)=b(21);
A1(82,82)=-b(20)-f(21)-f(23);
A1(82,83)=b(23);
A1(82,84)=f(20);
A1(83,80)=b(25);
A1(83,82)=f(23);
A1(83,83)=-b(23)-f(24)-f(25);
A1(83,86)=b(24);
A1(84,81)=b(10);
A1(84,82)=b(20);
A1(84,84)=-b(7)-b(8)-b(9)-f(10)-f(20)-f(35);
A1(85,81)=b(26);
A1(85,85)=-b(28)-f(26)-f(29)-f(39);
A1(85,87)=f(28);
A1(85,88)=b(29);
A1(86,83)=f(24);
A1(86,86)=-b(6)-b(24)-f(27)-f(38);
A1(86,87)=b(27);
A1(87,85)=b(28);
A1(87,86)=f(27);
A1(87,87)=-b(27)-b(30)-f(28);
A1(87,88)=f(30);
A1(88,85)=f(29);
A1(88,87)=b(30);
A1(88,88)=-b(29)-f(30);

B1=zeros(88,27);
B1(1,1)=-f(1);
B1(8,2)=-f(5);
B1(10,3)=-f(6);
B1(13,4)=-f(7);
B1(13,5)=-f(8);
B1(13,6)=-f(9);
B1(18,7)=-f(7);
B1(18,8)=-f(8);
B1(18,9)=-f(9);
B1(27,10)=-f(7);
B1(27,11)=-f(8);
B1(27,12)=-f(9);
B1(35,13)=-f(6);
B1(41,14)=-f(5);
B1(45,15)=-f(7);
B1(45,16)=-f(8);
B1(45,17)=-f(9);
B1(49,18)=-f(5);
B1(53,19)=-f(6);
B1(69,20)=-f(7);
B1(69,21)=-f(8);
B1(69,22)=-f(9);
B1(74,23)=-f(6);
B1(84,24)=-f(7);
B1(84,25)=-f(8);
B1(84,26)=-f(9);
B1(86,27)=-f(6);

y1=[ in.CO2_IN_1; in.PYR_IN_3; in.RIBOSE_IN_1; in.GLC_IN_3; in.GLYCOGEN_IN1_3; in.GLYCOGEN_IN2_3; in.GLC_IN_2; in.GLYCOGEN_IN1_2; in.GLYCOGEN_IN2_2; in.GLC_IN_1; in.GLYCOGEN_IN1_1; in.GLYCOGEN_IN2_1; in.RIBOSE_IN_2; in.PYR_IN_1; in.GLC_IN_4; in.GLYCOGEN_IN1_4; in.GLYCOGEN_IN2_4; in.PYR_IN_2; in.RIBOSE_IN_3; in.GLC_IN_5; in.GLYCOGEN_IN1_5; in.GLYCOGEN_IN2_5; in.RIBOSE_IN_4; in.GLC_IN_6; in.GLYCOGEN_IN1_6; in.GLYCOGEN_IN2_6; in.RIBOSE_IN_5];
x1=sparse(A1)\(B1*sparse(y1));

%%
A2=zeros(57);
A2(1,1)=-b(25)-f(26)-f(27);
A2(1,2)=b(26);
A2(1,3)=b(27);
A2(1,7)=f(25);
A2(2,1)=f(26);
A2(2,2)=-b(10)-b(26)-b(28)-f(11)-f(36);
A2(2,3)=f(28);
A2(2,8)=f(10);
A2(2,9)=b(11);
A2(3,1)=f(27);
A2(3,2)=b(28);
A2(3,3)=-b(27)-b(30)-f(28);
A2(3,10)=f(30);
A2(4,4)=-b(5)-b(19)-b(22)-f(42);
A2(4,11)=f(19);
A2(4,12)=f(22);
A2(5,5)=-b(27)-b(30)-f(28);
A2(5,13)=f(30);
A2(5,14)=b(28);
A2(6,6)=-b(12)-f(13)-f(29)-f(37);
A2(6,13)=b(29);
A2(6,15)=f(12);
A2(6,16)=b(13);
A2(7,1)=b(25);
A2(7,7)=-b(23)-f(24)-f(25);
A2(7,17)=f(23);
A2(7,18)=b(24);
A2(8,2)=b(10);
A2(8,8)=-b(7)-b(8)-b(9)-f(10)-f(20)-f(35);
A2(8,19)=b(20);
A2(9,2)=f(11);
A2(9,9)=-b(11)-f(12);
A2(9,20)=b(12);
A2(10,3)=b(30);
A2(10,10)=-b(29)-f(30);
A2(10,20)=f(29);
A2(11,4)=b(19);
A2(11,11)=-b(18)-f(19)-f(41);
A2(11,21)=f(18);
A2(12,4)=b(22);
A2(12,12)=-b(21)-f(22);
A2(12,17)=f(21);
A2(13,5)=b(30);
A2(13,6)=f(29);
A2(13,13)=-b(29)-f(30);
A2(14,5)=f(28);
A2(14,14)=-b(10)-b(26)-b(28)-f(11)-f(36);
A2(14,15)=b(11);
A2(14,22)=f(10);
A2(15,6)=b(12);
A2(15,14)=f(11);
A2(15,15)=-b(11)-f(12);
A2(16,6)=f(13);
A2(16,16)=-b(12)-b(13)-b(22)-b(26)-b(27)-f(14)-f(28);
A2(16,23)=f(12);
A2(16,24)=f(22);
A2(16,25)=f(26)+f(27);
A2(16,26)=b(14);
A2(16,27)=b(28);
A2(17,7)=b(23);
A2(17,12)=b(21);
A2(17,17)=-b(20)-f(21)-f(23);
A2(17,22)=f(20);
A2(18,7)=f(24);
A2(18,18)=-b(6)-b(24)-f(27)-f(38);
A2(18,28)=b(27);
A2(19,8)=f(20);
A2(19,19)=-b(20)-f(21)-f(23);
A2(19,29)=b(21);
A2(20,9)=f(12);
A2(20,10)=b(29);
A2(20,20)=-b(12)-f(13)-f(29)-f(37);
A2(20,30)=b(13);
A2(21,11)=b(18);
A2(21,21)=-b(17)-f(18);
A2(21,31)=f(17);
A2(22,14)=b(10);
A2(22,17)=b(20);
A2(22,22)=-b(7)-b(8)-b(9)-f(10)-f(20)-f(35);
A2(23,16)=b(12);
A2(23,23)=-b(11)-f(12);
A2(23,27)=f(11);
A2(24,16)=b(22);
A2(24,24)=-b(21)-f(22);
A2(24,32)=f(21);
A2(25,16)=b(26)+b(27);
A2(25,25)=-b(25)-f(26)-f(27);
A2(25,33)=f(25);
A2(26,16)=f(14);
A2(26,26)=-b(14)-f(15);
A2(26,34)=b(15);
A2(27,16)=f(28);
A2(27,23)=b(11);
A2(27,27)=-b(10)-b(26)-b(28)-f(11)-f(36);
A2(27,35)=f(10);
A2(27,36)=f(26);
A2(28,18)=f(27);
A2(28,28)=-b(27)-b(30)-f(28);
A2(28,37)=f(30);
A2(29,19)=f(21);
A2(29,29)=-b(21)-f(22);
A2(29,38)=b(22);
A2(30,20)=f(13);
A2(30,30)=-b(12)-b(13)-b(22)-b(26)-b(27)-f(14)-f(28);
A2(30,39)=f(12);
A2(30,40)=f(22);
A2(30,41)=f(26)+f(27);
A2(30,42)=b(14);
A2(30,43)=b(28);
A2(31,21)=b(17);
A2(31,31)=-b(16)-f(17);
A2(31,44)=f(16);
A2(32,24)=b(21);
A2(32,32)=-b(20)-f(21)-f(23);
A2(32,33)=b(23);
A2(32,35)=f(20);
A2(33,25)=b(25);
A2(33,32)=f(23);
A2(33,33)=-b(23)-f(24)-f(25);
A2(33,45)=b(24);
A2(34,26)=f(15);
A2(34,34)=-b(15)-f(16)-f(40);
A2(34,46)=b(16);
A2(35,27)=b(10);
A2(35,32)=b(20);
A2(35,35)=-b(7)-b(8)-b(9)-f(10)-f(20)-f(35);
A2(36,27)=b(26);
A2(36,36)=-b(28)-f(26)-f(29)-f(39);
A2(36,47)=f(28);
A2(36,48)=b(29);
A2(37,28)=b(30);
A2(37,37)=-b(29)-f(30);
A2(38,29)=f(22);
A2(38,38)=-b(5)-b(19)-b(22)-f(42);
A2(38,49)=f(19);
A2(39,30)=b(12);
A2(39,39)=-b(11)-f(12);
A2(39,43)=f(11);
A2(40,30)=b(22);
A2(40,40)=-b(21)-f(22);
A2(40,50)=f(21);
A2(41,30)=b(26)+b(27);
A2(41,41)=-b(25)-f(26)-f(27);
A2(41,51)=f(25);
A2(42,30)=f(14);
A2(42,42)=-b(14)-f(15);
A2(42,44)=b(15);
A2(43,30)=f(28);
A2(43,39)=b(11);
A2(43,43)=-b(10)-b(26)-b(28)-f(11)-f(36);
A2(43,52)=f(10);
A2(43,53)=f(26);
A2(44,31)=b(16);
A2(44,42)=f(15);
A2(44,44)=-b(15)-f(16)-f(40);
A2(45,33)=f(24);
A2(45,45)=-b(6)-b(24)-f(27)-f(38);
A2(45,47)=b(27);
A2(46,34)=f(16);
A2(46,46)=-b(16)-f(17);
A2(46,54)=b(17);
A2(47,36)=b(28);
A2(47,45)=f(27);
A2(47,47)=-b(27)-b(30)-f(28);
A2(47,48)=f(30);
A2(48,36)=f(29);
A2(48,47)=b(30);
A2(48,48)=-b(29)-f(30);
A2(49,38)=b(19);
A2(49,49)=-b(18)-f(19)-f(41);
A2(49,54)=f(18);
A2(50,40)=b(21);
A2(50,50)=-b(20)-f(21)-f(23);
A2(50,51)=b(23);
A2(50,52)=f(20);
A2(51,41)=b(25);
A2(51,50)=f(23);
A2(51,51)=-b(23)-f(24)-f(25);
A2(51,55)=b(24);
A2(52,43)=b(10);
A2(52,50)=b(20);
A2(52,52)=-b(7)-b(8)-b(9)-f(10)-f(20)-f(35);
A2(53,43)=b(26);
A2(53,53)=-b(28)-f(26)-f(29)-f(39);
A2(53,56)=f(28);
A2(53,57)=b(29);
A2(54,46)=f(17);
A2(54,49)=b(18);
A2(54,54)=-b(17)-f(18);
A2(55,51)=f(24);
A2(55,55)=-b(6)-b(24)-f(27)-f(38);
A2(55,56)=b(27);
A2(56,53)=b(28);
A2(56,55)=f(27);
A2(56,56)=-b(27)-b(30)-f(28);
A2(56,57)=f(30);
A2(57,53)=f(29);
A2(57,56)=b(30);
A2(57,57)=-b(29)-f(30);

B2=zeros(57,22);
B2(4,2)=-f(5);
B2(5,1)=-f(27);
B2(8,4)=-f(7);
B2(8,5)=-f(8);
B2(8,6)=-f(9);
B2(14,3)=-f(26);
B2(18,8)=-f(6);
B2(19,7)=-b(23);
B2(22,10)=-f(7);
B2(22,11)=-f(8);
B2(22,12)=-f(9);
B2(28,9)=-b(28);
B2(35,14)=-f(7);
B2(35,15)=-f(8);
B2(35,16)=-f(9);
B2(37,13)=-f(29);
B2(38,17)=-f(5);
B2(45,18)=-f(6);
B2(52,19)=-f(7);
B2(52,20)=-f(8);
B2(52,21)=-f(9);
B2(55,22)=-f(6);

y2=[ cauchy(x1(4,:),x1(10,:)); in.PYR_IN_2_3; cauchy(x1(4,:),x1(9,:)); in.GLC_IN_1_2; in.GLYCOGEN_IN1_1_2; in.GLYCOGEN_IN2_1_2; cauchy(x1(1,:),x1(11,:)); in.RIBOSE_IN_1_2; cauchy(x1(2,:),x1(9,:)); in.GLC_IN_2_3; in.GLYCOGEN_IN1_2_3; in.GLYCOGEN_IN2_2_3; cauchy(x1(3,:),x1(9,:)); in.GLC_IN_4_5; in.GLYCOGEN_IN1_4_5; in.GLYCOGEN_IN2_4_5; in.PYR_IN_1_2; in.RIBOSE_IN_3_4; in.GLC_IN_5_6; in.GLYCOGEN_IN1_5_6; in.GLYCOGEN_IN2_5_6; in.RIBOSE_IN_4_5];
x2=sparse(A2)\(B2*sparse(y2));

%%
A3=zeros(26);
A3(1,1)=-b(12)-b(13)-b(22)-b(26)-b(27)-f(14)-f(28);
A3(1,2)=f(13);
A3(1,3)=b(14);
A3(1,11)=f(12);
A3(1,12)=f(22);
A3(1,13)=f(26)+f(27);
A3(1,14)=b(28);
A3(2,1)=b(13);
A3(2,2)=-b(12)-f(13)-f(29)-f(37);
A3(2,15)=f(12);
A3(2,16)=b(29);
A3(3,1)=f(14);
A3(3,3)=-b(14)-f(15);
A3(3,4)=b(15);
A3(4,3)=f(15);
A3(4,4)=-b(15)-f(16)-f(40);
A3(4,5)=b(16);
A3(5,4)=f(16);
A3(5,5)=-b(16)-f(17);
A3(5,6)=b(17);
A3(6,5)=f(17);
A3(6,6)=-b(17)-f(18);
A3(6,7)=b(18);
A3(7,6)=f(18);
A3(7,7)=-b(18)-f(19)-f(41);
A3(7,8)=b(19);
A3(8,7)=f(19);
A3(8,8)=-b(5)-b(19)-b(22)-f(42);
A3(8,17)=f(22);
A3(9,9)=-b(10)-b(26)-b(28)-f(11)-f(36);
A3(9,10)=f(28);
A3(9,15)=b(11);
A3(9,18)=f(10);
A3(10,9)=b(28);
A3(10,10)=-b(27)-b(30)-f(28);
A3(10,16)=f(30);
A3(11,1)=b(12);
A3(11,11)=-b(11)-f(12);
A3(11,14)=f(11);
A3(12,1)=b(22);
A3(12,12)=-b(21)-f(22);
A3(12,19)=f(21);
A3(13,1)=b(26)+b(27);
A3(13,13)=-b(25)-f(26)-f(27);
A3(13,20)=f(25);
A3(14,1)=f(28);
A3(14,11)=b(11);
A3(14,14)=-b(10)-b(26)-b(28)-f(11)-f(36);
A3(14,21)=f(10);
A3(14,22)=f(26);
A3(15,2)=b(12);
A3(15,9)=f(11);
A3(15,15)=-b(11)-f(12);
A3(16,2)=f(29);
A3(16,10)=b(30);
A3(16,16)=-b(29)-f(30);
A3(17,8)=b(22);
A3(17,17)=-b(21)-f(22);
A3(17,23)=f(21);
A3(18,9)=b(10);
A3(18,18)=-b(7)-b(8)-b(9)-f(10)-f(20)-f(35);
A3(18,23)=b(20);
A3(19,12)=b(21);
A3(19,19)=-b(20)-f(21)-f(23);
A3(19,20)=b(23);
A3(19,21)=f(20);
A3(20,13)=b(25);
A3(20,19)=f(23);
A3(20,20)=-b(23)-f(24)-f(25);
A3(20,24)=b(24);
A3(21,14)=b(10);
A3(21,19)=b(20);
A3(21,21)=-b(7)-b(8)-b(9)-f(10)-f(20)-f(35);
A3(22,14)=b(26);
A3(22,22)=-b(28)-f(26)-f(29)-f(39);
A3(22,25)=f(28);
A3(22,26)=b(29);
A3(23,17)=b(21);
A3(23,18)=f(20);
A3(23,23)=-b(20)-f(21)-f(23);
A3(24,20)=f(24);
A3(24,24)=-b(6)-b(24)-f(27)-f(38);
A3(24,25)=b(27);
A3(25,22)=b(28);
A3(25,24)=f(27);
A3(25,25)=-b(27)-b(30)-f(28);
A3(25,26)=f(30);
A3(26,22)=f(29);
A3(26,25)=b(30);
A3(26,26)=-b(29)-f(30);

B3=zeros(26,11);
B3(8,3)=-f(5);
B3(9,1)=-f(26);
B3(10,2)=-f(27);
B3(18,5)=-f(7);
B3(18,6)=-f(8);
B3(18,7)=-f(9);
B3(21,8)=-f(7);
B3(21,9)=-f(8);
B3(21,10)=-f(9);
B3(23,4)=-b(23);
B3(24,11)=-f(6);

y3=[ cauchy(x2(1,:),x1(9,:)); cauchy(x2(1,:),x1(10,:)); in.PYR_IN_1_2_3; cauchy(x1(1,:),x2(7,:)); in.GLC_IN_1_2_3; in.GLYCOGEN_IN1_1_2_3; in.GLYCOGEN_IN2_1_2_3; in.GLC_IN_4_5_6; in.GLYCOGEN_IN1_4_5_6; in.GLYCOGEN_IN2_4_5_6; in.RIBOSE_IN_3_4_5];
x3=sparse(A3)\(B3*sparse(y3));

%%
A4=zeros(11);
A4(1,1)=-b(28)-f(26)-f(29)-f(39);
A4(1,2)=f(28);
A4(1,3)=b(26);
A4(1,4)=b(29);
A4(2,1)=b(28);
A4(2,2)=-b(27)-b(30)-f(28);
A4(2,4)=f(30);
A4(2,5)=f(27);
A4(3,1)=f(26);
A4(3,3)=-b(10)-b(26)-b(28)-f(11)-f(36);
A4(3,6)=f(10);
A4(3,7)=b(11);
A4(4,1)=f(29);
A4(4,2)=b(30);
A4(4,4)=-b(29)-f(30);
A4(5,2)=b(27);
A4(5,5)=-b(6)-b(24)-f(27)-f(38);
A4(5,8)=f(24);
A4(6,3)=b(10);
A4(6,6)=-b(7)-b(8)-b(9)-f(10)-f(20)-f(35);
A4(6,9)=b(20);
A4(7,3)=f(11);
A4(7,7)=-b(11)-f(12);
A4(8,5)=b(24);
A4(8,8)=-b(23)-f(24)-f(25);
A4(8,9)=f(23);
A4(8,10)=b(25);
A4(9,6)=f(20);
A4(9,8)=b(23);
A4(9,9)=-b(20)-f(21)-f(23);
A4(9,11)=b(21);
A4(10,8)=f(25);
A4(10,10)=-b(25)-f(26)-f(27);
A4(11,9)=f(21);
A4(11,11)=-b(21)-f(22);

B4=zeros(11,9);
B4(3,1)=-f(28);
B4(5,3)=-f(6);
B4(6,4)=-f(7);
B4(6,5)=-f(8);
B4(6,6)=-f(9);
B4(7,2)=-b(12);
B4(10,7)=-b(26);
B4(10,8)=-b(27);
B4(11,9)=-b(22);

y4=[ cauchy(x1(5,:),x3(1,:)); cauchy(x1(3,:),x3(1,:)); in.RIBOSE_IN_2_3_4_5; in.GLC_IN_3_4_5_6; in.GLYCOGEN_IN1_3_4_5_6; in.GLYCOGEN_IN2_3_4_5_6; cauchy(x1(6,:),x3(1,:)); cauchy(x1(7,:),x3(1,:)); cauchy(x1(8,:),x3(1,:))];
x4=sparse(A4)\(B4*sparse(y4));

%%
A5=zeros(10);
A5(1,1)=-b(23)-f(24)-f(25);
A5(1,2)=b(24);
A5(1,3)=b(25);
A5(1,4)=f(23);
A5(2,1)=f(24);
A5(2,2)=-b(6)-b(24)-f(27)-f(38);
A5(2,5)=b(27);
A5(3,1)=f(25);
A5(3,3)=-b(25)-f(26)-f(27);
A5(4,1)=b(23);
A5(4,4)=-b(20)-f(21)-f(23);
A5(4,6)=f(20);
A5(4,7)=b(21);
A5(5,2)=f(27);
A5(5,5)=-b(27)-b(30)-f(28);
A5(5,8)=f(30);
A5(6,4)=b(20);
A5(6,6)=-b(7)-b(8)-b(9)-f(10)-f(20)-f(35);
A5(6,9)=b(10);
A5(7,4)=f(21);
A5(7,7)=-b(21)-f(22);
A5(8,5)=b(30);
A5(8,8)=-b(29)-f(30);
A5(9,6)=f(10);
A5(9,9)=-b(10)-b(26)-b(28)-f(11)-f(36);
A5(9,10)=b(11);
A5(10,9)=f(11);
A5(10,10)=-b(11)-f(12);

B5=zeros(10,12);
B5(2,3)=-f(6);
B5(3,1)=-b(26);
B5(3,2)=-b(27);
B5(5,4)=-b(28);
B5(6,7)=-f(7);
B5(6,8)=-f(8);
B5(6,9)=-f(9);
B5(7,5)=-b(22);
B5(8,6)=-f(29);
B5(9,10)=-f(26);
B5(9,11)=-f(28);
B5(10,12)=-b(12);

y5=[ cauchy(x2(2,:),x3(1,:)); cauchy(x2(3,:),x3(1,:)); in.RIBOSE_IN_1_2_3_4_5; cauchy(x1(2,:),x4(1,:)); cauchy(x2(4,:),x3(1,:)); cauchy(x1(3,:),x4(1,:)); in.GLC_IN_2_3_4_5_6; in.GLYCOGEN_IN1_2_3_4_5_6; in.GLYCOGEN_IN2_2_3_4_5_6; cauchy(x1(4,:),x4(1,:)); cauchy(x2(5,:),x3(1,:)); cauchy(x2(6,:),x3(1,:))];
x5=A5\(B5*sparse(y5));

%%
A6=zeros(5);
A6(1,1)=-b(7)-b(8)-b(9)-f(10)-f(20)-f(35);
A6(1,2)=b(10);
A6(1,4)=b(20);
A6(2,1)=f(10);
A6(2,2)=-b(10)-b(26)-b(28)-f(11)-f(36);
A6(2,3)=b(11);
A6(3,2)=f(11);
A6(3,3)=-b(11)-f(12);
A6(4,1)=f(20);
A6(4,4)=-b(20)-f(21)-f(23);
A6(4,5)=b(21);
A6(5,4)=f(21);
A6(5,5)=-b(21)-f(22);

B6=zeros(5,8);
B6(1,6)=-f(7);
B6(1,7)=-f(8);
B6(1,8)=-f(9);
B6(2,1)=-f(26);
B6(2,2)=-f(28);
B6(3,3)=-b(12);
B6(4,4)=-b(23);
B6(5,5)=-b(22);

y6=[ cauchy(x2(1,:),x4(1,:)); cauchy(x3(10,:),x3(1,:)); cauchy(x3(2,:),x3(1,:)); cauchy(x1(1,:),x5(1,:)); cauchy(x3(8,:),x3(1,:)); in.GLC_IN_1_2_3_4_5_6; in.GLYCOGEN_IN1_1_2_3_4_5_6; in.GLYCOGEN_IN2_1_2_3_4_5_6];
x6=A6\(B6*sparse(y6));

%%
A7=zeros(2);
A7(1,1)=-b(27)-b(30)-f(28);
A7(1,2)=f(30);
A7(2,1)=b(30);
A7(2,2)=-b(29)-f(30);

B7=zeros(2,3);
B7(1,1)=-f(27);
B7(1,2)=-b(28);
B7(2,3)=-f(29);

y7=[ cauchy(x2(1,:),x5(2,:)); cauchy(x3(9,:),x4(1,:)); cauchy(x3(2,:),x4(1,:))];
x7=A7\(B7*sparse(y7));

%%
mol.g6p=x6(1,:);
mol.f6p=x6(2,:);
mol.fbp=x6(3,:);
mol.gap=x3(1,:);
mol.dhap=x3(2,:);
mol.bpg13=x3(3,:);
mol.pg3=x3(4,:);
mol.bpg23=x3(5,:);
mol.pg2=x3(6,:);
mol.pep=x3(7,:);
mol.pyr=x3(8,:);
mol.pg6=x6(4,:);
mol.ddg6p=x6(5,:);
mol.ru5p=x5(1,:);
mol.r5p=x5(2,:);
mol.xu5p=x5(3,:);
mol.s7p=x7(1,:);
mol.sbp=x7(2,:);
mol.e4p=x4(1,:);
mol.CO2=x1(1,:);